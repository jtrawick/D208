---
title: "D208 - Predictive Modeling"
output: 
  html_notebook: 
    toc: yes
    theme: lumen
---

</br>

------------------------------------------------------------------------

#### **Performance Assessment - Task 1: Multiple Regression for Predictive Modeling**

*Medical Readmission Data Set (Clean)*

------------------------------------------------------------------------

</br>

## Part I

### A1: Research Question

What variables from the medical dataset are related to and influence a patient's initial number of days spent after hospitalization? In terms of hypothesis testing, our null hypothesis (H0) is, "No combination of variables included in the medical dataset are related to initial length of stay in any statistically significant way. Additionally, our alternate hypothesis (H1) is, "Some combination of variables included in the medical dataset are related to initial length of stay in a statistically significant way".

### A2: Objectives and Goals

The main goal of the following analysis is to determine what variables, if any, contribute positively to a patient's initial number of days hospitalized. This will be assessed using the R programming language and the technique of multiple regression to identify a meaningful model.

</br>

## Part II

### B1: Summary of Assumptions

The following are basic assumptions of multiple linear regression:

-   The assumption of a linear relationship between the explanatory variables and the target variable
-   The assumption that residual values are normally distributed
-   The assumption of non-multicollinearity of explanatory variables
-   The assumption that residual values are homoscedastic

### B2: Tool Benefits

The programming language of choice for this analysis will be the R programming language. Previously, Python has been the language most utilized, however R happens to handle the tasks of regression exceptionally well and thus became the self-evident choice for multiple regression analysis. In particular, the built-in functions of the base R language used to fit models are incredibly simple to navigate as well as demonstrate. Additionally, the reduction process using the `ols_step_backward_p()` function in particular made the process even easier. It is for good reason that R has a reputation for handling regression models.

### B3: Appropriate Technique

Multiple regression is an appropriate technique to use to accomplish our goal of finding which variable contribute to a longer initial length of stay for several reasons. Firstly, the dataset contains 50 total variables of varying significance and utility. While some variable do not require much thought prior to elimination, some are not quite as straightforward. Therefore, running them through a multiple regression model prior to discarding them is a worthwhile venture. Additionally, multiple regression will allow us to see the significance of each variable's discrete contribution to the target variable as well as the interaction between explanatory variables themselves. Overall, regarding our objective, multiple regression is more than up to the task.

</br>

## Part III

### C1: Data Goals

### C2: Summary Statistics

### C3: Steps to Prepare the Data

```{r}
# Load in the tidyverse
# Suppress the overwritten functions messages
suppressPackageStartupMessages(library(tidyverse))
library(skimr)
```

```{r}
# Read dataset in
df <- read.csv("./data/medical_clean.csv")
```

```{r}
# Start with a quick glimpse of the data for orientation and future reference
glimpse(df)
```

Immediately we will drop variables that, at this time, are unnecessary for our objective and keep the rest.

```{r}
# Partition dataset to include only features to be initially included in model
# Initial_days is reordered to first position for ease of reference
init_mdl <- df %>%
  select(Initial_days,
         Area,
         Children:Services,
         TotalCharge,
         Additional_charges)
```

```{r}
# View new dataframe and assess dtypes
init_mdl %>%
  glimpse()
```

We will next need to convert the dtypes of many our variables. Since there are not any variables needing type class conversion other than those which are currently of the type Character, we will simply select all of those variables at once and convert them to factor variables. This will ensure that the model handles the variables as intended.

```{r}
# Start with reformatting all chr variables as fct
init_mdl[sapply(init_mdl, is.character)] <- lapply(init_mdl[sapply(init_mdl, is.character)], as.factor)

# Next, list cols that need conversion to factor type
fctvars <- colnames(init_mdl[sapply(init_mdl, class) == "character"])
init_mdl[fctvars] <- lapply(init_mdl[fctvars], factor)

summary(init_mdl)
```

```{r}
head(init_mdl["Gender"], 20)
```

```{r}
# Check to see if any conversions introduced null values silently 
anyNA.data.frame(init_mdl)
```

### C4: Visualizations

### C5: Prepared Data Set

</br>

## Part IV

### D1: Initial Model

### D2: Justification of Model Reduction

### D3: Reduced Multiple Regression Model

</br>

## Part V

### E1: Model Comparison

### E2: Output and Calculations

### E3: Code

```{r}
init_mdl <- lm(Initial_days ~
               Age +
               Gender +
               ReAdmis +
               VitD_levels +
               Doc_visits +
               Full_meals_eaten +
               vitD_supp +
               Soft_drink +
               Initial_admin +
               HighBlood +
               Stroke +
               Complication_risk +
               Overweight +
               Arthritis +
               Diabetes +
               Hyperlipidemia +
               BackPain +
               Anxiety +
               Allergic_rhinitis +
               Reflux_esophagitis +
               Asthma +
               Services,
               data = df_mdl)

summary(init_mdl)
```

```{r}
df_mdl_emergadmin <- df_mdl %>%
    filter(Initial_admin == "Emergency Admission")
```

```{r}
reduced_mdl <- lm(Initial_days ~
                  VitD_levels +
                  0 +
                  ReAdmis,
                  data = df_mdl_emergadmin)

summary(reduced_mdl)
```

</br>

## Part VI

### F1: Results

### F2: Recommendations

</br>

### I: Sources
